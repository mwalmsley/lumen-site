<?xml version="1.0" encoding="UTF-8"?><rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title><![CDATA[Blog by Mike Walmsley]]></title><description><![CDATA[Blog by Mike Walmsley]]></description><link>https://walmsley.dev</link><generator>RSS for Node</generator><lastBuildDate>Thu, 24 Oct 2019 17:19:38 GMT</lastBuildDate><item><title><![CDATA[GCR; Permission Denied - Unable to Determine Upload Size]]></title><description><![CDATA[Why this error happens and how to fix it]]></description><link>https://walmsley.dev/posts/perfecting-the-art-of-perfection/</link><guid isPermaLink="false">https://walmsley.dev/posts/perfecting-the-art-of-perfection/</guid><pubDate>Sun, 22 Sep 2019 23:46:37 GMT</pubDate><content:encoded>&lt;p&gt;Google Cloud has &lt;a href=&quot;https://cloud.google.com/compute/docs/containers/deploying-containers&quot;&gt;excellent container support&lt;/a&gt;, including GCR - a private container registry that automatically stores your containers on GCS. But GCR has a weird bug.&lt;/p&gt;
&lt;p&gt;The first time I try to push a new image:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;docker push $IMAGE_URI&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The upload runs for a few seconds and then fails with the curious error:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;denied: Unable to determine the upload&amp;#39;s size&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;What’s going on? &lt;/p&gt;
&lt;p&gt;GCR works by creating a bucket in GCS for your container. For reasons best known to Google, &lt;strong&gt;project owners do not automatically get write access to GCR buckets&lt;/strong&gt;. You need to explicitly give yourself permission.&lt;/p&gt;
&lt;p&gt;To do this, follow &lt;a href=&quot;https://cloud.google.com/container-registry/docs/access-control#granting_users_and_other_projects_access_to_a_registry&quot;&gt;this guide&lt;/a&gt;. Click the bucket, then permissions, add member. Enter your Google or Service account. Search for and select the role ‘Storage Admin’. &lt;/p&gt;
&lt;p&gt;You should know be able to push to your own GCR. &lt;/p&gt;
&lt;p&gt;Happy coding,&lt;/p&gt;
&lt;p&gt;Mike&lt;/p&gt;</content:encoded></item></channel></rss>