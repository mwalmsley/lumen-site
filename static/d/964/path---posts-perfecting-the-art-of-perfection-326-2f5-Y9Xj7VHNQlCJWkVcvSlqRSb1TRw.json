{"data":{"markdownRemark":{"id":"895630a6-6fa3-5928-ac8d-c48c7d62e201","html":"<p>Google Cloud has <a href=\"https://cloud.google.com/compute/docs/containers/deploying-containers\">excellent container support</a>, including GCR - a private container registry that automatically stores your containers on GCS. But GCR has a weird bug.</p>\n<p>The first time I try to push a new image:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">docker push $IMAGE_URI</code></pre></div>\n<p>The upload runs for a few seconds and then fails with the curious error:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">denied: Unable to determine the upload&#39;s size</code></pre></div>\n<p>What’s going on? </p>\n<p>GCR works by creating a bucket in GCS for your container. For reasons best known to Google, <strong>project owners do not automatically get write access to GCR buckets</strong>. You need to explicitly give yourself permission.</p>\n<p>To do this, follow <a href=\"https://cloud.google.com/container-registry/docs/access-control#granting_users_and_other_projects_access_to_a_registry\">this guide</a>. Click the bucket, then permissions, add member. Enter your Google or Service account. Search for and select the role ‘Storage Admin’. </p>\n<p>You should know be able to push to your own GCR. </p>\n<p>Happy coding,</p>\n<p>Mike</p>","fields":{"slug":"/posts/perfecting-the-art-of-perfection/","tagSlugs":["/tag/google-cloud/","/tag/containers/","/tag/docker/","/tag/bugs/"]},"frontmatter":{"date":"2019-09-22T23:46:37.121Z","description":"Why this error happens and how to fix it","tags":["google cloud","containers","docker","bugs"],"title":"GCR; Permission Denied - Unable to Determine Upload Size"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/posts/perfecting-the-art-of-perfection/"}}